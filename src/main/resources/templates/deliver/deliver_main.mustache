<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <button id="btnSend" class="btn btn-primary">Send Message</button>
<script
        src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.3.0/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<script>
    $(document).ready(  function() {
        connectStomp();
        $('#btnSend').on('click', function(evt) {
            evt.preventDefault();
            if (!isStomp && socket.readyState !== 1) return;

            if (isStomp)
                socket.send('/app/chat/assign', {}, JSON.stringify({roomid: 'message', id: 124}));
            else
                socket.send(msg);
        });
    });


    var socket = null;
    var isStomp = false;

    function connectStomp() {
        var sock = new SockJS("/deliver"); // endpoint
        var client = Stomp.over(sock);
        isStomp = true;
        socket = client;
        socket.connect({}, function (frame) {
            socket.send('/app/chat/create', {}, JSON.stringify({id:1}));
            socket.subscribe('/deliver/room/'+1,{});
            socket.send('/app/chat/refresh',{},JSON.stringify({id:1,lat:Number(135.1),lng:Number(35.1)}));
        });
    }
</script>
</body>
</html>